name: All pipeline

on:
  push:
    branches:
      - main

jobs:
  integration:  # Model Training, Testing, and Logging
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Set Up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'

      - name: Install Dependencies
        run: pip install -r requirements.txt

      - name: DVC
        run: |
          pip install dvc==3.58.0 
          dvc init
          dvc status

      # - name: Setup Azure CLI
      #   uses: azure/setup-cli@v2

      - name: Login to Azure
        run: echo 'logining to Azure'
        env:
          connection_string: ${{ secrets.connection_string }}
          raw_data_container_name: ${{ secrets.raw_data_container_name }}
          raw_data_name: ${{ secrets.raw_data_name }}

      - name: Start Development Process (Training, Testing, and Logging)
        run: python3 train.py
